---
title: "Strength of Evidence"
date: "`r format(Sys.time(), '%d %B, %Y (%H:%M)')`"
output:
  workflowr::wflow_html:
    font: Source Sans Pro
    theme: cosmo
    anchor_sections: TRUE 
    toc: yes
    toc_depth: 3
    toc_float: 
      collapsed: TRUE
      smooth_scroll: yes
    linkcolor: black
  latex_engine: xelatex
  pdf_document:
    toc: yes
    toc_depth: '4'
workflowr:
  suppress_report: TRUE
editor_options:
  chunk_output_type: console     
---

#### 

```{=html} 
<style type="text/css">
  body{
  font-size: 9.5pt;
  font-family: Source Sans Pro;
}

.list-group-item.active, .list-group-item.active:hover, .list-group-item.active:focus {
  color: #090909;
  background-color: #0909093d;
}

.lightable-classic.lightable-hover tbody tr:hover {
    background-color: #c5d4e4;
}
.btn-xs, .btn-group-xs>.btn { 
display: none; 
}

.btn-default {
display: none !important; 
}

@font-face {
    font-family: "GRADE-quality";
    src: url();
    src: url('https://gradepro.org/fonts/GRADE-quality.eot');
    src: url('https://gradepro.org/fonts/GRADE-quality.eot?#iefix')
        format('embedded-opentype'),
      url('https://gradepro.org/fonts/GRADE-quality.woff') format('woff'),
      url('https://gradepro.org/fonts/GRADE-quality.ttf') format('truetype'),
      url('https://gradepro.org/fonts/GRADE-quality.svg#GRADE-quality')
        format('svg');
    font-weight: normal;
    font-style: normal;
  }

.quality-sign {
      font-family: 'GRADE-quality', Cambria, Helvetica, Arial;
      font-size: 10px;
      vertical-align: text-top;
    }

span { font-size: 3em;}

span b { font-size: 60%; font-weight: normal }


</style>
```

```{r, include = FALSE}
## (updated 2021/05/13 11:47) preliminaries -------------------------------
knitr::opts_chunk$set(
  echo = FALSE, 
  options(knitr.kable.NA = "", dev = "svg"), 
  knitr.graphics.error = FALSE,
  warning = FALSE, message = FALSE
)

library(kableExtra)
library(janitor)
library(countrycode)
library(Cairo)
library(tidyverse)
library(naniar)
library(formattable)

opt_font <-  c("Source Sans Pro")
opt_boot <- c("striped", "hover", "condensed")

tab_inc <- function() {
  table_n <- table_n + 1
  table_n}

fig_inc <- function() {
  figure_n <- figure_n + 1
  figure_n}

table_n <- 1
figure_n <- 1

pack_sub <- function(kable_input, name, a, b) {
  pack_rows(kable_input, name,
            start_row = a, end_row = b,
            label_row_css = "border-bottom: 0px solid;", color = "black", background = "white", bold = FALSE
  )
}

pack_top <- function(kable_input, name, a, b) {
  pack_rows(kable_input, name,
            start_row = a, end_row = b,
            label_row_css = "border-top: 1px solid;", color = "black", background = "#EBEBEB"
  )
}

firstup <- function(x) {
  substr(x, 1, 1) <- toupper(substr(x, 1, 1))
  x
}
```

```{r soeData, include = TRUE}
## (updated 2021/05/13 11:45) soeData -------------------------------------
soe.dat <- readxl::read_xlsx("data/SOE_CHO_021921_edit.xlsx", range = "A1:AB98", sheet = "soe_050521") %>%
  clean_names() %>%
  mutate(
    n = paste0(n, outcome),
    # outcome = tools::toTitleCase(outcome) %>%
    outcome = str_to_sentence(outcome),
    outcome = ifelse(outcome == "Ph", "pH", outcome),
    outcome = str_replace(outcome, "Hunger", "Hunger (preop)"),
    outcome = str_replace(outcome, "Nausea", "Nausea (preop)"),
    outcome = str_replace(outcome, "Thirst", "Thirst (preop)"),
    outcome = str_replace(outcome, ", preoperative", " \\(preop\\)"),
    outcome = str_replace(outcome, ", postoperative", " \\(postop\\)"),
    outcome = str_replace(outcome, "<br> rct, nrsi, cohort|<br> rct|<br> non.*", ""),
    outcome = str_replace(outcome, "\\) \\(", ", "),
    outcome = str_replace(outcome, "Gastric ph", "pH"),
    outcome = str_replace(outcome, ", cohort", ""),
    design = str_replace(design, "Rct", "RCT"),
    design = str_replace(design, "rct", "RCT"),
    design = str_replace(design, "[Nn]rsi", "NRSI"),
    design = str_replace(design, "cohort", "Cohort"),
    design = str_replace(design, "observational", "Observational"),
    out_import = case_when(
      out_import == "Limited" ~ "●○○",
      out_import == "Important" ~ "●●○",
      out_import == "Critical" ~ "●●●"
    )
  )

soe.dat <- soe.dat %>% 
    filter((grepl("Hunger|Thirst|Regur|Vomit|Residual|pH|Nausea", outcome) & design %in% c("RCT","Crossover")) | grepl("Aspir", outcome))
  # filter(!(grepl("Hunger|Thirst|Regur|Vomit|Residual|pH|Nausea", outcome) & design %in% c("RCT","Crossover"))) %>%
  # filter(!grepl("Aspir", outcome))


## (updated 2021/05/13 13:48) soe_summary ---------------------------------
soe_summary <- soe.dat %>%
  select(n, comparison, outcome, grade, uspstf, acc, out_import, result_summary, result_links) %>%
  mutate(
    grade = case_when(
      grade == "very low" ~ '<span><span class="quality-sign">⨁</span><span class="quality-sign">◯</span><span class="quality-sign">◯</span><span class="quality-sign">◯</span>',
      grade == "low" ~ '<span><span class="quality-sign">⨁</span><span class="quality-sign">⨁</span><span class="quality-sign">◯</span><span class="quality-sign">◯</span>',
      grade == "moderate" ~ '<span><span class="quality-sign">⨁</span><span class="quality-sign">⨁</span><span class="quality-sign">⨁</span><span class="quality-sign">◯</span>',
      grade == "high" ~ '<span><span class="quality-sign">⨁</span><span class="quality-sign">⨁</span><span class="quality-sign">⨁</span><span class="quality-sign">⨁</span>', # )%>%
      TRUE ~ grade
    )
  )

## (updated 2021/05/14 06:08) domain_summary ------------------------------
domain_summary <- soe.dat %>% 
  select(n, comparison, outcome, design, n_studies, n_pts, rob, consist, direct, prec, other, summary, ends_with("foot")) %>% 
  mutate(design = str_to_sentence(design),
         consist_foot = ifelse(!grepl("\\.$", consist_foot) & !is.na(consist_foot), paste0(consist_foot, "."), consist_foot),
         direct_foot  = ifelse(!grepl("\\.$", direct_foot ) & !is.na(direct_foot ), paste0(direct_foot , "."), direct_foot ),
         prec_foot    = ifelse(!grepl("\\.$", prec_foot   ) & !is.na(prec_foot   ), paste0(prec_foot   , "."), prec_foot   ),
         rob_foot     = ifelse(!grepl("\\.$", rob_foot    ) & !is.na(rob_foot    ), paste0(rob_foot    , "."), rob_foot    ),
         other_foot   = ifelse(!grepl("\\.$", other_foot  ) & !is.na(other_foot  ), paste0(other_foot  , "."), other_foot  ),
         across(ends_with("foot"), firstup)
         ) 

```

<font size = 4> Ratings in the following tables are for selected important outcomes obtained from randomized controlled trials. Ratings for other outcomes and studies can be found in the [Appendix](appendix.html#supplSoe). </font>

# **Carbohydrate Drinks** 

<br/>

#    **Adult**

## *Carbohydrate vs. Fasting*

### Strength of Evidence Ratings

<br/>

<font size = 4> Table `r table_n`. Strength of evidence for selected important outcomes in randomized controlled trials comparing carbohydrate drinks with fasting in adults.  </font>

```{r chofasting, include = TRUE}
## (updated 2021/05/14 08:53) cho vs. fasting kable -----------------------
soe_summary %>% 
  filter(comparison == "CHO_fasting") %>% 
  select(!c(comparison, n)) %>% 
  # slice(1:12) %>% 
    kbl(booktabs = T, align = c("llcccll"), escape = FALSE,
    col.names = c("Outcome", " GRADE", "USPSTF/AHRQ", "ACC/AHA", "Importance", "&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; Summary", "Result Detail")) %>% 
  row_spec(0, bold = TRUE) %>% 
  add_header_above(c(" " = 1, "Strength of Evidence" = 3, " " = 1, " " = 2), line = TRUE, bold = TRUE) %>%
  kable_styling(bootstrap_options = opt_boot, position = "left") %>% 
  kable_classic(full_width = TRUE, html_font = opt_font, position = "left", "hover") %>%
  column_spec(1, width = "12em") %>%  
  column_spec(c(2:4), width = "6em") %>% 
  column_spec(5, width = "7em") %>% 
  column_spec(6, width = "26em") %>% 
  column_spec(7, width = "9em") %>% 
  # pack_top(., "Patient Reported Outcomes", 1, 2) %>%
  footnote(general = "RGV: residual gastric volume; NRSI: nonrandomized studies of intervensions; OR: odds ratio; SMD: standardized mean difference; MD: mean difference.",
           # alphabet = c("At time of endocoscopy = 0","'Did you feel hunger during the fasting period?'"),
           general_title = "",  
           footnote_as_chunk = FALSE)

table_n <- tab_inc()

```

<br/>

### GRADE Domains 

<br>

<font size = 4> Table `r table_n`. GRADE domains for strength of evidence ratings in studies comparing carbohydrate drinks with fasting in adults. </font>

```{r chofastingDomain, include = TRUE, eval = TRUE}
## (updated 2021/05/14 08:02) cho_domain_summary --------------------------
cho_domain_summary <- domain_summary %>%
  filter(comparison == "CHO_fasting") %>%
  select(-summary) %>%
  mutate(
    design = str_replace(design, "Rct", "RCT"),
    design = str_replace(design, "[Nn]rsi", "NRSI"),
    design = str_replace(design, "cohort", "Cohort"),
  )
         
## (updated 2021/05/14 07:42) get list of unique footnotes ----------------
foot_unique <- cho_domain_summary %>% 
  # slice(1:20) %>% 
  select(ends_with("foot")) 

foot_unique <- c(t(foot_unique)) %>% 
  unlist(use.names = FALSE) %>% 
  discard(is.na) 

foot_unique <- unique(foot_unique)

numbers <- c(1:100)
cho_domain <- cho_domain_summary %>% 
  mutate(rob_let     = numbers[match(rob_foot, foot_unique)],
         consist_let = numbers[match(consist_foot, foot_unique)],
         direct_let  = numbers[match(direct_foot, foot_unique)],
         prec_let    = numbers[match(prec_foot, foot_unique)],
         other_let   = numbers[match(other_foot, foot_unique)],
         )

## (updated 2021/05/14 08:04) add footnotes -------------------------------
for (i in 1:nrow(cho_domain)){
  for (j in 7:11){
    cho_domain[i,j] =  ifelse(!is.na(cho_domain[i,j + 10]), paste0(cho_domain[i,j], "^", cho_domain[i,j + 10], "^"), cho_domain[i,j])
  }
}

## (updated 2021/05/14 08:27) domain summary table ------------------------
cho_domain %>% 
  mutate(n_s = paste0(n_studies, " (", n_pts, ")")) %>% 
  select(outcome, design, n_s, rob, consist, direct, prec, other) %>% 
    kbl(booktabs = T, align = c("llllllll"), escape = FALSE, padding = 10, 
    col.names = c("Outcome", "Design", "N (pts)", "Bias", "Inconsistency", "Indirectness", "Imprecision", "Other")) %>% 
  row_spec(0, bold = TRUE) %>% 
  add_header_above(c(" " = 1, "Studies" = 2, "Domains" = 5), line = TRUE, bold = TRUE) %>%
  kable_styling(bootstrap_options = opt_boot, position = "left") %>% 
  kable_classic(full_width = FALSE, html_font = opt_font, position = "left", "hover") %>%
  column_spec(1, width = "13em") %>%  
  column_spec(2, width = "4em") %>% 
  column_spec(3, width = "10em") %>% 
  column_spec(4:8, width = "8em") %>% 
  footnote(general = "RCT: randomized controlled trials; NRSI: nonrandomized studies of intervensions.",
           number = foot_unique,
           general_title = "",  
           footnote_as_chunk = FALSE)

table_n <- tab_inc()
```

<br/>

<hr style="height:2px;border-width:0;color:gray;background-color:gray">

<br/>

## *Carbohydrate vs. Clear Liquids, Water*

### Strength of Evidence Ratings

<br/>

<font size = 4> Table `r table_n`. Strength of evidence for selected important outcomes in randomized controlled trials comparing carbohydrate drinks with clear liquids or water in adults.  </font>

```{r choClear, include = TRUE}
## (updated 2021/05/14 08:53) cho vs. fasting kable -----------------------
soe_summary %>% 
  filter(comparison == "CHO_clear") %>% 
  select(!c(comparison, n)) %>% 
    kbl(booktabs = T, align = c("llcccll"), escape = FALSE,
    col.names = c("Outcome", " GRADE", "USPSTF/AHRQ", "ACC/AHA", "Importance", "&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; Summary", "Result Detail")) %>% 
  row_spec(0, bold = TRUE) %>% 
  add_header_above(c(" " = 1, "Strength of Evidence" = 3, " " = 1, " " = 2), line = TRUE, bold = TRUE) %>%
  kable_styling(bootstrap_options = opt_boot, position = "left") %>% 
  kable_classic(full_width = TRUE, html_font = opt_font, position = "left", "hover") %>%
  column_spec(1, width = "12em") %>%  
  column_spec(c(2:4), width = "6em") %>% 
  column_spec(5, width = "7em") %>% 
  column_spec(6, width = "26em") %>% 
  column_spec(7, width = "9em") %>% 
  # pack_top(., "Patient Reported Outcomes", 1, 2) %>%
  footnote(general = "RGV: residual gastric volume; NRSI: nonrandomized studies of intervensions; OR: odds ratio; SMD: standardized mean difference; MD: mean difference.",
           # alphabet = c("At time of endocoscopy = 0","'Did you feel hunger during the fasting period?'"),
           general_title = "",  
           footnote_as_chunk = FALSE)

table_n <- tab_inc()

```

<br/>

### GRADE Domains 

<br/>

<font size = 4> Table `r table_n`. GRADE domains for strength of evidence ratings in studies comparing carbohydrate drinks with clear liquids or water in adults. </font>

```{r choClearDomain, include = TRUE, eval = TRUE}
## (updated 2021/05/14 08:02) cho_domain_summary --------------------------
cho_domain_summary <- domain_summary %>%
  filter(comparison == "CHO_clear") %>%
  select(-summary) %>%
  mutate(
    design = str_replace(design, "Rct", "RCT"),
    design = str_replace(design, "[Nn]rsi", "NRSI"),
    design = str_replace(design, "cohort", "Cohort"),
  )
         
## (updated 2021/05/14 07:42) get list of unique footnotes ----------------
foot_unique <- cho_domain_summary %>% 
  # slice(1:20) %>% 
  select(ends_with("foot")) 

foot_unique <- c(t(foot_unique)) %>% 
  unlist(use.names = FALSE) %>% 
  discard(is.na) 

foot_unique <- unique(foot_unique)

numbers <- c(1:100)
cho_domain <- cho_domain_summary %>% 
  mutate(rob_let     = numbers[match(rob_foot, foot_unique)],
         consist_let = numbers[match(consist_foot, foot_unique)],
         direct_let  = numbers[match(direct_foot, foot_unique)],
         prec_let    = numbers[match(prec_foot, foot_unique)],
         other_let   = numbers[match(other_foot, foot_unique)],
         )

## (updated 2021/05/14 08:04) add footnotes -------------------------------
for (i in 1:nrow(cho_domain)){
  for (j in 7:11){
    cho_domain[i,j] =  ifelse(!is.na(cho_domain[i,j + 10]), paste0(cho_domain[i,j], "^", cho_domain[i,j + 10], "^"), cho_domain[i,j])
  }
}

## (updated 2021/05/14 08:27) domain summary table ------------------------
cho_domain %>% 
  mutate(n_s = paste0(n_studies, " (", n_pts, ")")) %>% 
  select(outcome, design, n_s, rob, consist, direct, prec, other) %>% 
    kbl(booktabs = T, align = c("llllllll"), escape = FALSE, padding = 10, 
    col.names = c("Outcome", "Design", "N (pts)", "Bias", "Inconsistency", "Indirectness", "Imprecision", "Other")) %>% 
  row_spec(0, bold = TRUE) %>% 
  add_header_above(c(" " = 1, "Studies" = 2, "Domains" = 5), line = TRUE, bold = TRUE) %>%
  kable_styling(bootstrap_options = opt_boot, position = "left") %>% 
  kable_classic(full_width = FALSE, html_font = opt_font, position = "left", "hover") %>%
  column_spec(1, width = "13em") %>%  
  column_spec(2, width = "4em") %>% 
  column_spec(3, width = "10em") %>% 
  column_spec(4:8, width = "8em") %>% 
  footnote(general = "RCT: randomized controlled trials; NRSI: nonrandomized studies of intervensions.",
           number = foot_unique,
           general_title = "",  
           footnote_as_chunk = FALSE)

table_n <- tab_inc()
```

<br/>

<hr style="height:2px;border-width:0;color:gray;background-color:gray">

<br/>


#    **Pediatric**

## *Carbohydrate vs. Fasting*

### Strength of Evidence Ratings

<br/>

<font size = 4> Table `r table_n`. Strength of evidence for selected important outcomes in randomized controlled trials comparing carbohydrate drinks with fasting in the pediatric population.  </font>

```{r chofastingpeds, include = TRUE}
## (updated 2021/05/14 08:53) cho vs. fasting kable -----------------------
soe_summary %>% 
  filter(comparison == "CHO_fasting_peds") %>% 
  select(!c(comparison, n)) %>% 
    kbl(booktabs = T, align = c("llcccll"), escape = FALSE,
    col.names = c("Outcome", " GRADE", "USPSTF/AHRQ", "ACC/AHA", "Importance", "&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; Summary", "Result Detail")) %>% 
  row_spec(0, bold = TRUE) %>% 
  # add_header_above(c(" " = 4, "LI" = 1, " " = 2), line = FALSE, angle = -45, font_size = 3) %>% 
  add_header_above(c(" " = 1, "Strength of Evidence" = 3, " " = 1, " " = 2), line = TRUE, bold = TRUE) %>%
  kable_styling(bootstrap_options = opt_boot, position = "left") %>% 
  kable_classic(full_width = TRUE, html_font = opt_font, position = "left", "hover") %>%
  column_spec(1, width = "12em") %>%  
  column_spec(c(2:4), width = "6em") %>% 
  column_spec(5, width = "7em") %>% 
  column_spec(6, width = "26em") %>% 
  column_spec(7, width = "9em") %>% 
  # pack_top(., "Patient Reported Outcomes", 1, 2) %>%
  footnote(general = "RGV: residual gastric volume; NRSI: nonrandomized studies of intervensions; OR: odds ratio; SMD: standardized mean difference; MD: mean difference.",
           # alphabet = c("At time of endocoscopy = 0","'Did you feel hunger during the fasting period?'"),
           general_title = "",  
           footnote_as_chunk = FALSE)

table_n <- tab_inc()

```

<br/>

### GRADE Domains 

<br>

<font size = 4> Table `r table_n`. GRADE domains for strength of evidence ratings in studies comparing carbohydrate drinks with fasting in the pediatric population. </font>

```{r chofastingPedsDomain, include = TRUE, eval = TRUE}
## (updated 2021/05/14 08:02) cho_domain_summary --------------------------
cho_domain_summary <- domain_summary %>%
  filter(comparison == "CHO_fasting_peds") %>%
  select(-summary) %>%
  mutate(
    design = str_replace(design, "Rct", "RCT"),
    design = str_replace(design, "[Nn]rsi", "NRSI"),
    design = str_replace(design, "cohort", "Cohort"),
  )
         
## (updated 2021/05/14 07:42) get list of unique footnotes ----------------
foot_unique <- cho_domain_summary %>% 
  # slice(1:20) %>% 
  select(ends_with("foot")) 

foot_unique <- c(t(foot_unique)) %>% 
  unlist(use.names = FALSE) %>% 
  discard(is.na) 

foot_unique <- unique(foot_unique)

numbers <- c(1:100)
cho_domain <- cho_domain_summary %>% 
  mutate(rob_let     = numbers[match(rob_foot, foot_unique)],
         consist_let = numbers[match(consist_foot, foot_unique)],
         direct_let  = numbers[match(direct_foot, foot_unique)],
         prec_let    = numbers[match(prec_foot, foot_unique)],
         other_let   = numbers[match(other_foot, foot_unique)],
         )

## (updated 2021/05/14 08:04) add footnotes -------------------------------
for (i in 1:nrow(cho_domain)){
  for (j in 7:11){
    cho_domain[i,j] =  ifelse(!is.na(cho_domain[i,j + 10]), paste0(cho_domain[i,j], "^", cho_domain[i,j + 10], "^"), cho_domain[i,j])
  }
}

## (updated 2021/05/14 08:27) domain summary table ------------------------
cho_domain %>% 
  mutate(n_s = paste0(n_studies, " (", n_pts, ")")) %>% 
  select(outcome, design, n_s, rob, consist, direct, prec, other) %>% 
    kbl(booktabs = T, align = c("llllllll"), escape = FALSE, padding = 10, 
    col.names = c("Outcome", "Design", "N (pts)", "Bias", "Inconsistency", "Indirectness", "Imprecision", "Other")) %>% 
  row_spec(0, bold = TRUE) %>% 
  add_header_above(c(" " = 1, "Studies" = 2, "Domains" = 5), line = TRUE, bold = TRUE) %>%
  kable_styling(bootstrap_options = opt_boot, position = "left") %>% 
  kable_classic(full_width = FALSE, html_font = opt_font, position = "left", "hover") %>%
  column_spec(1, width = "13em") %>%  
  column_spec(2, width = "4em") %>% 
  column_spec(3, width = "10em") %>% 
  column_spec(4:8, width = "8em") %>% 
  footnote(general = "RCT: randomized controlled trials; NRSI: nonrandomized studies of intervensions.",
           number = foot_unique,
           general_title = "",  
           footnote_as_chunk = FALSE)

table_n <- tab_inc()
```

<br/>

<hr style="height:2px;border-width:0;color:gray;background-color:gray">

<br/>

## *Carbohydrate vs. Clear Liquids, Water*

### Strength of Evidence Ratings

<br/>

<font size = 4> Table `r table_n`. Strength of evidence for selected important outcomes in randomized controlled trials comparing carbohydrate drinks with clear liquids or water in the pediatric population.  </font>

```{r choPedsClear, include = TRUE}
## (updated 2021/05/14 08:53) cho vs. fasting kable -----------------------
soe_summary %>% 
  filter(comparison == "CHO_clear_peds") %>% 
  select(!c(comparison, n)) %>% 
    kbl(booktabs = T, align = c("llcccll"), escape = FALSE,
    col.names = c("Outcome", " GRADE", "USPSTF/AHRQ", "ACC/AHA", "Importance", "&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; Summary", "Result Detail")) %>% 
  row_spec(0, bold = TRUE) %>% 
  # add_header_above(c(" " = 4, "LI" = 1, " " = 2), line = FALSE, angle = -45, font_size = 3) %>% 
  add_header_above(c(" " = 1, "Strength of Evidence" = 3, " " = 1, " " = 2), line = TRUE, bold = TRUE) %>%
  kable_styling(bootstrap_options = opt_boot, position = "left") %>% 
  kable_classic(full_width = TRUE, html_font = opt_font, position = "left", "hover") %>%
  column_spec(1, width = "12em") %>%  
  column_spec(c(2:4), width = "6em") %>% 
  column_spec(5, width = "7em") %>% 
  column_spec(6, width = "26em") %>% 
  column_spec(7, width = "9em") %>% 
  # pack_top(., "Patient Reported Outcomes", 1, 2) %>%
  footnote(general = "RGV: residual gastric volume; NRSI: nonrandomized studies of intervensions; OR: odds ratio; SMD: standardized mean difference; MD: mean difference.",
           # alphabet = c("At time of endocoscopy = 0","'Did you feel hunger during the fasting period?'"),
           general_title = "",  
           footnote_as_chunk = FALSE)

table_n <- tab_inc()

```

<br/>

### GRADE Domains 

<br/>

<font size = 4> Table `r table_n`. GRADE domains for strength of evidence ratings in studies comparing carbohydrate drinks with clear liquids or water in the pediatric population. </font>

```{r choPedsClearDomain, include = TRUE, eval = TRUE}
## (updated 2021/05/14 08:02) cho_domain_summary --------------------------
cho_domain_summary <- domain_summary %>%
  filter(comparison == "CHO_clear_peds") %>%
  select(-summary) %>%
  mutate(
    design = str_replace(design, "Rct", "RCT"),
    design = str_replace(design, "[Nn]rsi", "NRSI"),
    design = str_replace(design, "cohort", "Cohort"),
  )
         
## (updated 2021/05/14 07:42) get list of unique footnotes ----------------
foot_unique <- cho_domain_summary %>% 
  # slice(1:20) %>% 
  select(ends_with("foot")) 

foot_unique <- c(t(foot_unique)) %>% 
  unlist(use.names = FALSE) %>% 
  discard(is.na) 

foot_unique <- unique(foot_unique)

numbers <- c(1:100)
cho_domain <- cho_domain_summary %>% 
  mutate(rob_let     = numbers[match(rob_foot, foot_unique)],
         consist_let = numbers[match(consist_foot, foot_unique)],
         direct_let  = numbers[match(direct_foot, foot_unique)],
         prec_let    = numbers[match(prec_foot, foot_unique)],
         other_let   = numbers[match(other_foot, foot_unique)],
         )

## (updated 2021/05/14 08:04) add footnotes -------------------------------
for (i in 1:nrow(cho_domain)){
  for (j in 7:11){
    cho_domain[i,j] =  ifelse(!is.na(cho_domain[i,j + 10]), paste0(cho_domain[i,j], "^", cho_domain[i,j + 10], "^"), cho_domain[i,j])
  }
}

## (updated 2021/05/14 08:27) domain summary table ------------------------
cho_domain %>% 
  mutate(n_s = paste0(n_studies, " (", n_pts, ")")) %>% 
  select(outcome, design, n_s, rob, consist, direct, prec, other) %>% 
    kbl(booktabs = T, align = c("llllllll"), escape = FALSE, padding = 10, 
    col.names = c("Outcome", "Design", "N (pts)", "Bias", "Inconsistency", "Indirectness", "Imprecision", "Other")) %>% 
  row_spec(0, bold = TRUE) %>% 
  add_header_above(c(" " = 1, "Studies" = 2, "Domains" = 5), line = TRUE, bold = TRUE) %>%
  kable_styling(bootstrap_options = opt_boot, position = "left") %>% 
  kable_classic(full_width = FALSE, html_font = opt_font, position = "left", "hover") %>%
  column_spec(1, width = "13em") %>%  
  column_spec(2, width = "4em") %>% 
  column_spec(3, width = "10em") %>% 
  column_spec(4:8, width = "8em") %>% 
  footnote(general = "RCT: randomized controlled trials; NRSI: nonrandomized studies of intervensions.",
           number = foot_unique,
           general_title = "",  
           footnote_as_chunk = FALSE)

table_n <- tab_inc()
```

<br/>

<hr style="height:2px;border-width:0;color:gray;background-color:gray">

<br/>

## *Carbohydrate vs. Milk*

### Strength of Evidence Ratings

<br/>

<font size = 4> Table `r table_n`. Strength of evidence for selected important outcomes in randomized controlled trials comparing carbohydrate drinks with milk in the pediatric population.  </font>

```{r choPedsMilk, include = TRUE}
## (updated 2021/05/14 08:53) cho vs. fasting kable -----------------------
soe_summary %>% 
  filter(comparison == "CHO_milk_peds") %>% 
  select(!c(comparison, n)) %>% 
    kbl(booktabs = T, align = c("llcccll"), escape = FALSE,
    col.names = c("Outcome", " GRADE", "USPSTF/AHRQ", "ACC/AHA", "Importance", "&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; Summary", "Result Detail")) %>% 
  row_spec(0, bold = TRUE) %>% 
  # add_header_above(c(" " = 4, "LI" = 1, " " = 2), line = FALSE, angle = -45, font_size = 3) %>% 
  add_header_above(c(" " = 1, "Strength of Evidence" = 3, " " = 1, " " = 2), line = TRUE, bold = TRUE) %>%
  kable_styling(bootstrap_options = opt_boot, position = "left") %>% 
  kable_classic(full_width = TRUE, html_font = opt_font, position = "left", "hover") %>%
  column_spec(1, width = "12em") %>%  
  column_spec(c(2:4), width = "6em") %>% 
  column_spec(5, width = "7em") %>% 
  column_spec(6, width = "26em") %>% 
  column_spec(7, width = "9em") %>% 
  # pack_top(., "Patient Reported Outcomes", 1, 2) %>%
  footnote(general = "RGV: residual gastric volume; NRSI: nonrandomized studies of intervensions; OR: odds ratio; SMD: standardized mean difference; MD: mean difference.",
           # alphabet = c("At time of endocoscopy = 0","'Did you feel hunger during the fasting period?'"),
           general_title = "",  
           footnote_as_chunk = FALSE)

table_n <- tab_inc()

```

<br/>

<hr style="height:2px;border-width:0;color:gray;background-color:gray">

<br/>



### GRADE Domains 

<br/>

<font size = 4> Table `r table_n`. GRADE domains for strength of evidence ratings in studies comparing carbohydrate drinks with milk in the pediatric population. </font>

```{r choPedsMilkDomain, include = TRUE, eval = TRUE}
## (updated 2021/05/14 08:02) cho_domain_summary --------------------------
cho_domain_summary <- domain_summary %>%
  filter(comparison == "CHO_milk_peds") %>%
  select(-summary) %>%
  mutate(
    design = str_replace(design, "Rct", "RCT"),
    design = str_replace(design, "[Nn]rsi", "NRSI"),
    design = str_replace(design, "cohort", "Cohort"),
  )
         
## (updated 2021/05/14 07:42) get list of unique footnotes ----------------
foot_unique <- cho_domain_summary %>% 
  # slice(1:20) %>% 
  select(ends_with("foot")) 

foot_unique <- c(t(foot_unique)) %>% 
  unlist(use.names = FALSE) %>% 
  discard(is.na) 

foot_unique <- unique(foot_unique)

numbers <- c(1:100)
cho_domain <- cho_domain_summary %>% 
  mutate(rob_let     = numbers[match(rob_foot, foot_unique)],
         consist_let = numbers[match(consist_foot, foot_unique)],
         direct_let  = numbers[match(direct_foot, foot_unique)],
         prec_let    = numbers[match(prec_foot, foot_unique)],
         other_let   = numbers[match(other_foot, foot_unique)],
         )

## (updated 2021/05/14 08:04) add footnotes -------------------------------
for (i in 1:nrow(cho_domain)){
  for (j in 7:11){
    cho_domain[i,j] =  ifelse(!is.na(cho_domain[i,j + 10]), paste0(cho_domain[i,j], "^", cho_domain[i,j + 10], "^"), cho_domain[i,j])
  }
}

## (updated 2021/05/14 08:27) domain summary table ------------------------
cho_domain %>% 
  mutate(n_s = paste0(n_studies, " (", n_pts, ")")) %>% 
  select(outcome, design, n_s, rob, consist, direct, prec, other) %>% 
    kbl(booktabs = T, align = c("llllllll"), escape = FALSE, padding = 10, 
    col.names = c("Outcome", "Design", "N (pts)", "Bias", "Inconsistency", "Indirectness", "Imprecision", "Other")) %>% 
  row_spec(0, bold = TRUE) %>% 
  add_header_above(c(" " = 1, "Studies" = 2, "Domains" = 5), line = TRUE, bold = TRUE) %>%
  kable_styling(bootstrap_options = opt_boot, position = "left") %>% 
  kable_classic(full_width = FALSE, html_font = opt_font, position = "left", "hover") %>%
  column_spec(1, width = "13em") %>%  
  column_spec(2, width = "4em") %>% 
  column_spec(3, width = "10em") %>% 
  column_spec(4:8, width = "8em") %>% 
  footnote(general = "RCT: randomized controlled trials; NRSI: nonrandomized studies of intervensions.",
           number = foot_unique,
           general_title = "",  
           footnote_as_chunk = FALSE)

table_n <- tab_inc()
```


<br/><br/>

<hr style="height:2px;border-width:0;color:gray;background-color:gray">

<br/>

# **Protein-containing Drinks**

<br/>

#    **Adult**

## *Protein vs. Fasting*

### Strength of Evidence Ratings

<br/>

<font size = 4> Table `r table_n`. Strength of evidence for selected important outcomes in randomized controlled trials comparing protein drinks with fasting in adults.  </font>

```{r protfasting, include = TRUE}
## (updated 2021/05/14 08:53) prot vs. fasting kable -----------------------
soe_summary %>% 
  filter(comparison == "Prot_fasting") %>% 
  select(!c(comparison, n)) %>% 
    kbl(booktabs = T, align = c("llcccll"), escape = FALSE,
    col.names = c("Outcome", " GRADE", "USPSTF/AHRQ", "ACC/AHA", "Importance", "&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; Summary", "Result Detail")) %>% 
  row_spec(0, bold = TRUE) %>% 
  # add_header_above(c(" " = 4, "LI" = 1, " " = 2), line = FALSE, angle = -45, font_size = 3) %>% 
  add_header_above(c(" " = 1, "Strength of Evidence" = 3, " " = 1, " " = 2), line = TRUE, bold = TRUE) %>%
  kable_styling(bootstrap_options = opt_boot, position = "left") %>% 
  kable_classic(full_width = TRUE, html_font = opt_font, position = "left", "hover") %>%
  column_spec(1, width = "12em") %>%  
  column_spec(c(2:4), width = "6em") %>% 
  column_spec(5, width = "7em") %>% 
  column_spec(6, width = "26em") %>% 
  column_spec(7, width = "9em") %>% 
  # pack_top(., "Patient Reported Outcomes", 1, 2) %>%
  footnote(general = "RGV: residual gastric volume; NRSI: nonrandomized studies of intervensions; OR: odds ratio; SMD: standardized mean difference; MD: mean difference.",
           # alphabet = c("At time of endocoscopy = 0","'Did you feel hunger during the fasting period?'"),
           general_title = "",  
           footnote_as_chunk = FALSE)

table_n <- tab_inc()

```

<br/>

### GRADE Domains 

<br>

<font size = 4> Table `r table_n`. GRADE domains for strength of evidence ratings in studies comparing carbohydrate drinks with fasting in adults. </font>

```{r protfastingDomain, include = TRUE, eval = TRUE}
## (updated 2021/05/14 08:02) prot_domain_summary --------------------------
prot_domain_summary <- domain_summary %>%
  filter(comparison == "Prot_fasting") %>%
  select(-summary) %>%
  mutate(
    design = str_replace(design, "Rct", "RCT"),
    design = str_replace(design, "[Nn]rsi", "NRSI"),
    design = str_replace(design, "cohort", "Cohort"),
  )
         
## (updated 2021/05/14 07:42) get list of unique footnotes ----------------
foot_unique <- prot_domain_summary %>% 
  # slice(1:20) %>% 
  select(ends_with("foot")) 

foot_unique <- c(t(foot_unique)) %>% 
  unlist(use.names = FALSE) %>% 
  discard(is.na) 

foot_unique <- unique(foot_unique)

numbers <- c(1:100)
prot_domain <- prot_domain_summary %>% 
  mutate(rob_let     = numbers[match(rob_foot, foot_unique)],
         consist_let = numbers[match(consist_foot, foot_unique)],
         direct_let  = numbers[match(direct_foot, foot_unique)],
         prec_let    = numbers[match(prec_foot, foot_unique)],
         other_let   = numbers[match(other_foot, foot_unique)],
         )

## (updated 2021/05/14 08:04) add footnotes -------------------------------
for (i in 1:nrow(prot_domain)){
  for (j in 7:11){
    prot_domain[i,j] =  ifelse(!is.na(prot_domain[i,j + 10]), paste0(prot_domain[i,j], "^", prot_domain[i,j + 10], "^"), prot_domain[i,j])
  }
}

## (updated 2021/05/14 08:27) domain summary table ------------------------
prot_domain %>% 
  mutate(n_s = paste0(n_studies, " (", n_pts, ")")) %>% 
  select(outcome, design, n_s, rob, consist, direct, prec, other) %>% 
    kbl(booktabs = T, align = c("llllllll"), escape = FALSE, padding = 10, 
    col.names = c("Outcome", "Design", "N (pts)", "Bias", "Inconsistency", "Indirectness", "Imprecision", "Other")) %>% 
  row_spec(0, bold = TRUE) %>% 
  add_header_above(c(" " = 1, "Studies" = 2, "Domains" = 5), line = TRUE, bold = TRUE) %>%
  kable_styling(bootstrap_options = opt_boot, position = "left") %>% 
  kable_classic(full_width = FALSE, html_font = opt_font, position = "left", "hover") %>%
  column_spec(1, width = "13em") %>%  
  column_spec(2, width = "4em") %>% 
  column_spec(3, width = "10em") %>% 
  column_spec(4:8, width = "8em") %>% 
  footnote(general = "RCT: randomized controlled trials; NRSI: nonrandomized studies of intervensions.",
           number = foot_unique,
           general_title = "",  
           footnote_as_chunk = FALSE)

table_n <- tab_inc()
```

<br/>

<hr style="height:2px;border-width:0;color:gray;background-color:gray">

<br/>

## *Protein vs. Clear Liquids, Water*

### Strength of Evidence Ratings

<br/>

<font size = 4> Table `r table_n`. Strength of evidence for selected important outcomes in randomized controlled trials comparing protein/carbohydrate drinks with clear liquids or water in adults.  </font>

```{r protClear, include = TRUE}
## (updated 2021/05/14 08:53) prot vs. fasting kable -----------------------
soe_summary %>% 
  filter(comparison == "Prot_clear") %>% 
  select(!c(comparison, n)) %>% 
    kbl(booktabs = T, align = c("llcccll"), escape = FALSE,
    col.names = c("Outcome", " GRADE", "USPSTF/AHRQ", "ACC/AHA", "Importance", "&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; Summary", "Result Detail")) %>% 
  row_spec(0, bold = TRUE) %>% 
  # add_header_above(c(" " = 4, "LI" = 1, " " = 2), line = FALSE, angle = -45, font_size = 3) %>% 
  add_header_above(c(" " = 1, "Strength of Evidence" = 3, " " = 1, " " = 2), line = TRUE, bold = TRUE) %>%
  kable_styling(bootstrap_options = opt_boot, position = "left") %>% 
  kable_classic(full_width = TRUE, html_font = opt_font, position = "left", "hover") %>%
  column_spec(1, width = "12em") %>%  
  column_spec(c(2:4), width = "6em") %>% 
  column_spec(5, width = "7em") %>% 
  column_spec(6, width = "26em") %>% 
  column_spec(7, width = "9em") %>% 
  # pack_top(., "Patient Reported Outcomes", 1, 2) %>%
  footnote(general = "RGV: residual gastric volume; NRSI: nonrandomized studies of intervensions; OR: odds ratio; SMD: standardized mean difference; MD: mean difference.",
           # alphabet = c("At time of endocoscopy = 0","'Did you feel hunger during the fasting period?'"),
           general_title = "",  
           footnote_as_chunk = FALSE)

table_n <- tab_inc()

```

<br/>

### GRADE Domains 

<br/>

<font size = 4> Table `r table_n`. GRADE domains for strength of evidence ratings in studies comparing protein/carbohydrate drinks with clear liquids or water in adults. </font>

```{r protClearDomain, include = TRUE, eval = TRUE}
## (updated 2021/05/14 08:02) prot_domain_summary --------------------------
prot_domain_summary <- domain_summary %>%
  filter(comparison == "Prot_clear") %>%
  select(-summary) %>%
  mutate(
    design = str_replace(design, "Rct", "RCT"),
    design = str_replace(design, "[Nn]rsi", "NRSI"),
    design = str_replace(design, "cohort", "Cohort"),
  )
         
## (updated 2021/05/14 07:42) get list of unique footnotes ----------------
foot_unique <- prot_domain_summary %>% 
  # slice(1:20) %>% 
  select(ends_with("foot")) 

foot_unique <- c(t(foot_unique)) %>% 
  unlist(use.names = FALSE) %>% 
  discard(is.na) 

foot_unique <- unique(foot_unique)

numbers <- c(1:100)
prot_domain <- prot_domain_summary %>% 
  mutate(rob_let     = numbers[match(rob_foot, foot_unique)],
         consist_let = numbers[match(consist_foot, foot_unique)],
         direct_let  = numbers[match(direct_foot, foot_unique)],
         prec_let    = numbers[match(prec_foot, foot_unique)],
         other_let   = numbers[match(other_foot, foot_unique)],
         )

## (updated 2021/05/14 08:04) add footnotes -------------------------------
for (i in 1:nrow(prot_domain)){
  for (j in 7:11){
    prot_domain[i,j] =  ifelse(!is.na(prot_domain[i,j + 10]), paste0(prot_domain[i,j], "^", prot_domain[i,j + 10], "^"), prot_domain[i,j])
  }
}

## (updated 2021/05/14 08:27) domain summary table ------------------------
prot_domain %>% 
  mutate(n_s = paste0(n_studies, " (", n_pts, ")")) %>% 
  select(outcome, design, n_s, rob, consist, direct, prec, other) %>% 
    kbl(booktabs = T, align = c("llllllll"), escape = FALSE, padding = 10, 
    col.names = c("Outcome", "Design", "N (pts)", "Bias", "Inconsistency", "Indirectness", "Imprecision", "Other")) %>% 
  row_spec(0, bold = TRUE) %>% 
  add_header_above(c(" " = 1, "Studies" = 2, "Domains" = 5), line = TRUE, bold = TRUE) %>%
  kable_styling(bootstrap_options = opt_boot, position = "left") %>% 
  kable_classic(full_width = FALSE, html_font = opt_font, position = "left", "hover") %>%
  column_spec(1, width = "13em") %>%  
  column_spec(2, width = "4em") %>% 
  column_spec(3, width = "10em") %>% 
  column_spec(4:8, width = "8em") %>% 
  footnote(general = "RCT: randomized controlled trials; NRSI: nonrandomized studies of intervensions.",
           number = foot_unique,
           general_title = "",  
           footnote_as_chunk = FALSE)

table_n <- tab_inc()
```

<br/>

<hr style="height:2px;border-width:0;color:gray;background-color:gray">

<br/>

## *Protein/Carbohydrate vs. Carbohydrate*

### Strength of Evidence Ratings

<br/>

<font size = 4> Table `r table_n`. Strength of evidence for selected important outcomes in randomized controlled trials comparing protein/carbohydrate with carbohydrate alone liquids in adults.  </font>

```{r protCHO, include = TRUE}
## (updated 2021/05/14 08:53) prot vs. fasting kable -----------------------
soe_summary %>% 
  filter(comparison == "Prot_CHO") %>% 
  select(!c(comparison, n)) %>% 
    kbl(booktabs = T, align = c("llcccll"), escape = FALSE,
    col.names = c("Outcome", " GRADE", "USPSTF/AHRQ", "ACC/AHA", "Importance", "&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; Summary", "Result Detail")) %>% 
  row_spec(0, bold = TRUE) %>% 
  # add_header_above(c(" " = 4, "LI" = 1, " " = 2), line = FALSE, angle = -45, font_size = 3) %>% 
  add_header_above(c(" " = 1, "Strength of Evidence" = 3, " " = 1, " " = 2), line = TRUE, bold = TRUE) %>%
  kable_styling(bootstrap_options = opt_boot, position = "left") %>% 
  kable_classic(full_width = TRUE, html_font = opt_font, position = "left", "hover") %>%
  column_spec(1, width = "12em") %>%  
  column_spec(c(2:4), width = "6em") %>% 
  column_spec(5, width = "7em") %>% 
  column_spec(6, width = "26em") %>% 
  column_spec(7, width = "9em") %>% 
  # pack_top(., "Patient Reported Outcomes", 1, 2) %>%
  footnote(general = "RGV: residual gastric volume; NRSI: nonrandomized studies of intervensions; OR: odds ratio; SMD: standardized mean difference; MD: mean difference.",
           # alphabet = c("At time of endocoscopy = 0","'Did you feel hunger during the fasting period?'"),
           general_title = "",  
           footnote_as_chunk = FALSE)

table_n <- tab_inc()

```

<br/>

### GRADE Domains 

<br/>

<font size = 4> Table `r table_n`. GRADE domains for strength of evidence ratings in studies comparing protein/carbohydrate with carbohydrate alone liquids in adults. </font>

```{r protCHODomain, include = TRUE, eval = TRUE}
## (updated 2021/05/14 08:02) prot_domain_summary --------------------------
prot_domain_summary <- domain_summary %>%
  filter(comparison == "Prot_CHO") %>%
  select(-summary) %>%
  mutate(
    design = str_replace(design, "Rct", "RCT"),
    design = str_replace(design, "[Nn]rsi", "NRSI"),
    design = str_replace(design, "cohort", "Cohort"),
  )
         
## (updated 2021/05/14 07:42) get list of unique footnotes ----------------
foot_unique <- prot_domain_summary %>% 
  # slice(1:20) %>% 
  select(ends_with("foot")) 

foot_unique <- c(t(foot_unique)) %>% 
  unlist(use.names = FALSE) %>% 
  discard(is.na) 

foot_unique <- unique(foot_unique)

numbers <- c(1:100)
prot_domain <- prot_domain_summary %>% 
  mutate(rob_let     = numbers[match(rob_foot, foot_unique)],
         consist_let = numbers[match(consist_foot, foot_unique)],
         direct_let  = numbers[match(direct_foot, foot_unique)],
         prec_let    = numbers[match(prec_foot, foot_unique)],
         other_let   = numbers[match(other_foot, foot_unique)],
         )

## (updated 2021/05/14 08:04) add footnotes -------------------------------
for (i in 1:nrow(prot_domain)){
  for (j in 7:11){
    prot_domain[i,j] =  ifelse(!is.na(prot_domain[i,j + 10]), paste0(prot_domain[i,j], "^", prot_domain[i,j + 10], "^"), prot_domain[i,j])
  }
}

## (updated 2021/05/14 08:27) domain summary table ------------------------
prot_domain %>% 
  mutate(n_s = paste0(n_studies, " (", n_pts, ")")) %>% 
  select(outcome, design, n_s, rob, consist, direct, prec, other) %>% 
    kbl(booktabs = T, align = c("llllllll"), escape = FALSE, padding = 10, 
    col.names = c("Outcome", "Design", "N (pts)", "Bias", "Inconsistency", "Indirectness", "Imprecision", "Other")) %>% 
  row_spec(0, bold = TRUE) %>% 
  add_header_above(c(" " = 1, "Studies" = 2, "Domains" = 5), line = TRUE, bold = TRUE) %>%
  kable_styling(bootstrap_options = opt_boot, position = "left") %>% 
  kable_classic(full_width = FALSE, html_font = opt_font, position = "left", "hover") %>%
  column_spec(1, width = "13em") %>%  
  column_spec(2, width = "4em") %>% 
  column_spec(3, width = "10em") %>% 
  column_spec(4:8, width = "8em") %>% 
  footnote(general = "RCT: randomized controlled trials; NRSI: nonrandomized studies of intervensions.",
           number = foot_unique,
           general_title = "",  
           footnote_as_chunk = FALSE)

table_n <- tab_inc()
```

<br/>

<hr style="height:2px;border-width:0;color:gray;background-color:gray">

<br/>

#    **Pediatric**

## *Protein/Carbohydrate vs. Milk*

### Strength of Evidence Ratings

<br/>

<font size = 4> Table `r table_n`.Strength of evidence for selected important outcomes in randomized controlled trials comparing protein/carbohydrate with milk in a pediatric population.  </font>

```{r protMilk, include = TRUE}
## (updated 2021/05/14 08:53) prot vs. fasting kable -----------------------
soe_summary %>% 
  filter(comparison == "Prot_milk_peds") %>% 
  select(!c(comparison, n)) %>% 
    kbl(booktabs = T, align = c("llcccll"), escape = FALSE,
    col.names = c("Outcome", " GRADE", "USPSTF/AHRQ", "ACC/AHA", "Importance", "&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; Summary", "Result Detail")) %>% 
  row_spec(0, bold = TRUE) %>% 
  # add_header_above(c(" " = 4, "LI" = 1, " " = 2), line = FALSE, angle = -45, font_size = 3) %>% 
  add_header_above(c(" " = 1, "Strength of Evidence" = 3, " " = 1, " " = 2), line = TRUE, bold = TRUE) %>%
  kable_styling(bootstrap_options = opt_boot, position = "left") %>% 
  kable_classic(full_width = TRUE, html_font = opt_font, position = "left", "hover") %>%
  column_spec(1, width = "12em") %>%  
  column_spec(c(2:4), width = "6em") %>% 
  column_spec(5, width = "7em") %>% 
  column_spec(6, width = "26em") %>% 
  column_spec(7, width = "9em") %>% 
  # pack_top(., "Patient Reported Outcomes", 1, 2) %>%
  footnote(general = "RGV: residual gastric volume; NRSI: nonrandomized studies of intervensions; OR: odds ratio; SMD: standardized mean difference; MD: mean difference.",
           # alphabet = c("At time of endocoscopy = 0","'Did you feel hunger during the fasting period?'"),
           general_title = "",  
           footnote_as_chunk = FALSE)

table_n <- tab_inc()

```

<br/>

### GRADE Domains 

<br/>

<font size = 4> Table `r table_n`. GRADE domains for strength of evidence ratings in studies comparing protein/carbohydrate with milk in a pediatric population. </font>

```{r protMilkDomain, include = TRUE, eval = TRUE}
## (updated 2021/05/14 08:02) prot_domain_summary --------------------------
prot_domain_summary <- domain_summary %>%
  filter(comparison == "Prot_milk_peds") %>%
  select(-summary) %>%
  mutate(
    design = str_replace(design, "Rct", "RCT"),
    design = str_replace(design, "[Nn]rsi", "NRSI"),
    design = str_replace(design, "cohort", "Cohort"),
  )
         
## (updated 2021/05/14 07:42) get list of unique footnotes ----------------
foot_unique <- prot_domain_summary %>% 
  # slice(1:20) %>% 
  select(ends_with("foot")) 

foot_unique <- c(t(foot_unique)) %>% 
  unlist(use.names = FALSE) %>% 
  discard(is.na) 

foot_unique <- unique(foot_unique)

numbers <- c(1:100)
prot_domain <- prot_domain_summary %>% 
  mutate(rob_let     = numbers[match(rob_foot, foot_unique)],
         consist_let = numbers[match(consist_foot, foot_unique)],
         direct_let  = numbers[match(direct_foot, foot_unique)],
         prec_let    = numbers[match(prec_foot, foot_unique)],
         other_let   = numbers[match(other_foot, foot_unique)],
         )

## (updated 2021/05/14 08:04) add footnotes -------------------------------
for (i in 1:nrow(prot_domain)){
  for (j in 7:11){
    prot_domain[i,j] =  ifelse(!is.na(prot_domain[i,j + 10]), paste0(prot_domain[i,j], "^", prot_domain[i,j + 10], "^"), prot_domain[i,j])
  }
}

## (updated 2021/05/14 08:27) domain summary table ------------------------
prot_domain %>% 
  mutate(n_s = paste0(n_studies, " (", n_pts, ")")) %>% 
  select(outcome, design, n_s, rob, consist, direct, prec, other) %>% 
    kbl(booktabs = T, align = c("llllllll"), escape = FALSE, padding = 10, 
    col.names = c("Outcome", "Design", "N (pts)", "Bias", "Inconsistency", "Indirectness", "Imprecision", "Other")) %>% 
  row_spec(0, bold = TRUE) %>% 
  add_header_above(c(" " = 1, "Studies" = 2, "Domains" = 5), line = TRUE, bold = TRUE) %>%
  kable_styling(bootstrap_options = opt_boot, position = "left") %>% 
  kable_classic(full_width = FALSE, html_font = opt_font, position = "left", "hover") %>%
  column_spec(1, width = "13em") %>%  
  column_spec(2, width = "4em") %>% 
  column_spec(3, width = "10em") %>% 
  column_spec(4:8, width = "8em") %>% 
  footnote(general = "RCT: randomized controlled trials; NRSI: nonrandomized studies of intervensions.",
           number = foot_unique,
           general_title = "",  
           footnote_as_chunk = FALSE)

table_n <- tab_inc()
```

<br/>

<hr style="height:2px;border-width:0;color:gray;background-color:gray">

<br/>

# **Chewing Gum**

### Strength of Evidence Ratings

<br/>

<font size = 4> Table `r table_n`. Strength of evidence in chewing gum studies.  </font>

```{r gum, include = TRUE}
## (updated 2021/05/14 08:53) prot vs. fasting kable -----------------------
soe_summary %>% 
  mutate(outcome = str_replace(outcome, "ph", "pH")) %>% 
  filter(grepl("gum", comparison)) %>% 
  select(!c(comparison, n)) %>% 
    kbl(booktabs = T, align = c("llcccll"), escape = FALSE,
    col.names = c("Outcome", " GRADE", "USPSTF/AHRQ", "ACC/AHA", "Importance", "&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; Summary", "Result Detail")) %>% 
  row_spec(0, bold = TRUE) %>% 
  # add_header_above(c(" " = 4, "LI" = 1, " " = 2), line = FALSE, angle = -45, font_size = 3) %>% 
  add_header_above(c(" " = 1, "Strength of Evidence" = 3, " " = 1, " " = 2), line = TRUE, bold = TRUE) %>%
  kable_styling(bootstrap_options = opt_boot, position = "left") %>% 
  kable_classic(full_width = TRUE, html_font = opt_font, position = "left", "hover") %>%
  column_spec(1, width = "12em") %>%  
  column_spec(c(2:4), width = "6em") %>% 
  column_spec(5, width = "7em") %>% 
  column_spec(6, width = "26em") %>% 
  column_spec(7, width = "9em") %>% 
  # pack_top(., "Gum vs.Fasting", 1, 3) %>%
  # pack_top(., "Gum vs. Water", 4, 4) %>%
  # pack_top(., "Gum vs. Fasting, Pediatric", 5, 6) %>%
  # pack_top(., "Gum", 7, 7) %>%
  # pack_top(., "Safety", 8, 8) %>%
  footnote(general = "RGV: residual gastric volume; NRSI: nonrandomized studies of intervensions; OR: odds ratio; SMD: standardized mean difference; MD: mean difference.",
           # alphabet = c("At time of endocoscopy = 0","'Did you feel hunger during the fasting period?'"),
           general_title = "",  
           footnote_as_chunk = FALSE)

table_n <- tab_inc()

```

<br/>

### GRADE Domains 

<br/>

<font size = 4> Table `r table_n`. GRADE domains for strength of evidence ratings in n chewing gum studies. </font>

```{r gumDomain, include = TRUE, eval = TRUE}
## (updated 2021/05/14 08:02) gum_domain_summary --------------------------
gum_domain_summary <- domain_summary %>%
  filter(grepl("gum", comparison)) %>% 
  select(-summary) %>%
  mutate(
    design = str_replace(design, "Rct", "RCT"),
    design = str_replace(design, "[Nn]rsi", "NRSI"),
    design = str_replace(design, "cohort", "Cohort"),
  )
         
## (updated 2021/05/14 07:42) get list of unique footnotes ----------------
foot_unique <- gum_domain_summary %>% 
  # slice(1:20) %>% 
  select(ends_with("foot")) 

foot_unique <- c(t(foot_unique)) %>% 
  unlist(use.names = FALSE) %>% 
  discard(is.na) 

foot_unique <- unique(foot_unique)

numbers <- c(1:100)
gum_domain <- gum_domain_summary %>% 
  mutate(rob_let     = numbers[match(rob_foot, foot_unique)],
         consist_let = numbers[match(consist_foot, foot_unique)],
         direct_let  = numbers[match(direct_foot, foot_unique)],
         prec_let    = numbers[match(prec_foot, foot_unique)],
         other_let   = numbers[match(other_foot, foot_unique)],
         )

## (updated 2021/05/14 08:04) add footnotes -------------------------------
for (i in 1:nrow(gum_domain)){
  for (j in 7:11){
    gum_domain[i,j] =  ifelse(!is.na(gum_domain[i,j + 10]), paste0(gum_domain[i,j], "^", gum_domain[i,j + 10], "^"), gum_domain[i,j])
  }
}

## (updated 2021/05/14 08:27) domain summary table ------------------------
gum_domain %>% 
  mutate(n_s = paste0(n_studies, " (", n_pts, ")")) %>% 
  select(outcome, design, n_s, rob, consist, direct, prec, other) %>% 
    kbl(booktabs = T, align = c("llllllll"), escape = FALSE, padding = 10, 
    col.names = c("Outcome", "Design", "N (pts)", "Bias", "Inconsistency", "Indirectness", "Imprecision", "Other")) %>% 
  row_spec(0, bold = TRUE) %>% 
  add_header_above(c(" " = 1, "Studies" = 2, "Domains" = 5), line = TRUE, bold = TRUE) %>%
  kable_styling(bootstrap_options = opt_boot, position = "left") %>% 
  kable_classic(full_width = FALSE, html_font = opt_font, position = "left", "hover") %>%
  column_spec(1, width = "13em") %>%  
  column_spec(2, width = "4em") %>% 
  column_spec(3, width = "10em") %>% 
  column_spec(4:8, width = "8em") %>% 
  footnote(general = "RCT: randomized controlled trials; NRSI: nonrandomized studies of intervensions.",
           number = foot_unique,
           general_title = "",  
           footnote_as_chunk = FALSE)

table_n <- tab_inc()
```

<br/>

<hr style="height:2px;border-width:0;color:gray;background-color:gray">

<br/>



# **Ratings Reference**

## GRADE

<br>
<font size = 4> 
**High** --- We are very confident that the true effect lies close to that of the estimate of the effect.

**Moderate** ---  We are moderately confident in the effect estimate: The true effect is likely to be close to the estimate of the effect, but there is a possibility that it is substantially different.

**Low** --- Our confidence in the effect estimate is limited: The true effect may be substantially different from the estimate of the effect.

**Very Low** ---  We have very little confidence in the effect estimate: The true effect is likely to be substantially different from the estimate of effect. 

</font>

### Domains (downgrading)
<font size = 3>

*Bias* --- Systematic error (eg, selection bias, confounding bias, measurement bias).

*Inconsistency* --- Unexplained heterogeneity of results; studies find effect estimates that differ widely.

*Imprecision* --- The range of plausible effects estimated from relevant studies.

*Indirectness* --- Direct evidence consists of research that directly compares the interventions which we are interested in, delivered to the populations in which we are interested, and measures the outcomes important to patients.

*Other (eg, publication bias)* Selective publication or reporting of results (typically of positive results).

### Domains (updgrading)

*Effect Size*

*Dose-response*

*Plausible Residual Confounding*

</font>

<br>

## USPSTF/AHRQ

<font size = 3>
**High** --- We are very confident that the estimate of effect lies close to the true effect for this outcome. The body of evidence has few or no deficiencies. We believe that the findings are stable, i.e., another study would not change the conclusions.

**Moderate** --- We are moderately confident that the estimate of effect lies close to the true effect for this outcome. The body of evidence has some deficiencies. We believe that the findings are likely to be stable, but some doubt remains.

**Low** --- We have limited confidence that the estimate of effect lies close to the true effect for this outcome. The body of evidence has major or numerous deficiencies (or both). We believe that additional evidence is needed before concluding either that the findings are stable or that the estimate of effect is close to the true effect.

**Insufficient** --- We have no evidence, we are unable to estimate an effect, or we have no confidence in the estimate of effect for this outcome. No evidence is available or the body of evidence has unacceptable deficiencies, precluding reaching a conclusion. 

<br>

## ACC/AHA

**Level A** --- High-quality evidence from more than 1 RCTs. Meta-analyses of high-quality RCTs. One or more RCTs corroborated by high-quality registry studies.

**Level B-R** --- Moderate-quality evidence from 1 or more randomized controlled trials. Meta-analyses of moderate-quality RCTs.

**Level B-NR** --- Moderate-quality evidence from 1 or more well-designed, well-executed nonrandomized studies, observational studies, or registry studies. Meta-analyses of such studies.

**Level C-LD** --- Randomized or nonrandomized observational or registry studies with limitations of design or execution. Meta-analyses of such studies. Physiological or mechanistic studies in human subjects.

**Level C-EO** --- Consensus of expert opinion based on clinical experience when evidence is insufficient, vague, or conflicting. 

</font>

<font size = 3> RCT: randomized controlled trial; NR: nonrandomized; LD: limited data; EO: expert opinion </font>









  
  


